{"version":3,"sources":["youtube-playlist-views.min.js"],"names":["_interopRequireDefault","obj","__esModule","default","getViewsText","pid","selector","options","findViewsText","$","selText","_regenerator2","async","_context","prev","next","uri","headers","accept-language","qs","list","transform","body","_cheerio2","load","_ramda2","find","pipe","match","complement","isEmpty","awrap","_requestPromise2","sent","map","key","val","text","get","Error","abrupt","stop","this","viewsTextToNum","numPart","trim","split","head","ifEmptyToBeZero","when","equals","always","toNumber","replace","parseInt","views","viewsText","_context2","Object","defineProperty","exports","value","undefined","_regenerator","require","_ramda","_requestPromise","_cheerio","playlist"],"mappings":"AAAA,YAuBA,SAASA,wBAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GAEvF,QAASG,cAAaC,GACpB,GAAIC,GAAUC,EAASC,EAAeC,EAAGC,CACzC,OAAOC,eAAAA,WAAsBC,MAAM,SAAuBC,GACxD,OACE,OAAQA,EAASC,KAAOD,EAASE,MAC/B,IAAK,GAYH,MAXAT,GAAW,mCACXC,GACES,IAAK,mCACLC,SAAWC,kBAAmB,MAC9BC,IAAMC,KAAMf,GACZgB,UAAW,SAAmBC,GAC5B,MAAOC,WAAAA,WAAkBC,KAAKF,KAGlCd,EAAgBiB,QAAAA,WAAgBC,KAAKD,QAAAA,WAAgBE,KAAKF,QAAAA,WAAgBG,MAAM,SAAUH,QAAAA,WAAgBI,WAAWJ,QAAAA,WAAgBK,WACrIjB,EAASE,KAAO,EACTJ,cAAAA,WAAsBoB,OAAM,EAAIC,iBAAAA,YAA0BzB,GAEnE,KAAK,GAMH,GALAE,EAAII,EAASoB,KACbvB,EAAUD,EAAEH,GAAU4B,IAAI,SAAUC,EAAKC,GACvC,MAAO3B,GAAE2B,GAAKC,SACbC,OAEEb,QAAAA,WAAgBK,QAAQpB,GAAU,CACrCG,EAASE,KAAO,CAChB,OAGF,KAAM,IAAIwB,OAAM,2BAElB,KAAK,GACH,MAAO1B,GAAS2B,OAAO,SAAUhC,EAAcE,GAEjD,KAAK,IACL,IAAK,MACH,MAAOG,GAAS4B,SAGrB,KAAMC,MAGX,QAASC,gBAAeN,GACtB,GAAIO,GAAUnB,QAAAA,WAAgBE,KAAKF,QAAAA,WAAgBoB,KAAMpB,QAAAA,WAAgBqB,MAAM,KAAMrB,QAAAA,WAAgBsB,MACjGC,EAAkBvB,QAAAA,WAAgBwB,KAAKxB,QAAAA,WAAgByB,OAAO,MAAOzB,QAAAA,WAAgB0B,OAAO,MAC5FC,EAAW3B,QAAAA,WAAgBE,KAAKF,QAAAA,WAAgB4B,QAAQ,KAAM,IAAKC,SAEvE,OAAO7B,SAAAA,WAAgBE,KAAKiB,EAASI,EAAiBI,GAAUf,GAGlE,QAASkB,OAAMlD,GACb,GAAImD,EACJ,OAAO7C,eAAAA,WAAsBC,MAAM,SAAgB6C,GACjD,OACE,OAAQA,EAAU3C,KAAO2C,EAAU1C,MACjC,IAAK,GAEH,MADA0C,GAAU1C,KAAO,EACVJ,cAAAA,WAAsBoB,MAAM3B,aAAaC,GAElD,KAAK,GAEH,MADAmD,GAAYC,EAAUxB,KACfwB,EAAUjB,OAAO,SAAUG,eAAea,GAEnD,KAAK,GACL,IAAK,MACH,MAAOC,GAAUhB,SAGtB,KAAMC,MA5FXgB,OAAOC,eAAeC,QAAS,cAC7BC,OAAO,IAETD,QAAQjB,eAAiBiB,QAAQxD,aAAewD,QAAQL,MAAQO,MAEhE,IAAIC,cAAeC,QAAQ,6BAEvBrD,cAAgBX,uBAAuB+D,cAEvCE,OAASD,QAAQ,SAEjBvC,QAAUzB,uBAAuBiE,QAEjCC,gBAAkBF,QAAQ,mBAE1BhC,iBAAmBhC,uBAAuBkE,iBAE1CC,SAAWH,QAAQ,WAEnBzC,UAAYvB,uBAAuBmE,UA4EnCC,UAAab,MAAOA,MAAOnD,aAAcA,aAAcuC,eAAgBA,eAE3EiB,SAAAA,WAAkBQ,SAClBR,QAAQL,MAAQA,MAChBK,QAAQxD,aAAeA,aACvBwD,QAAQjB,eAAiBA","file":"youtube-playlist-views.min.js","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.viewsTextToNum = exports.getViewsText = exports.views = undefined;\n\nvar _regenerator = require('babel-runtime/regenerator');\n\nvar _regenerator2 = _interopRequireDefault(_regenerator);\n\nvar _ramda = require('ramda');\n\nvar _ramda2 = _interopRequireDefault(_ramda);\n\nvar _requestPromise = require('request-promise');\n\nvar _requestPromise2 = _interopRequireDefault(_requestPromise);\n\nvar _cheerio = require('cheerio');\n\nvar _cheerio2 = _interopRequireDefault(_cheerio);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction getViewsText(pid) {\n  var selector, options, findViewsText, $, selText;\n  return _regenerator2.default.async(function getViewsText$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          selector = '#pl-header .pl-header-details li';\n          options = {\n            uri: 'https://www.youtube.com/playlist',\n            headers: { 'accept-language': 'en' },\n            qs: { list: pid },\n            transform: function transform(body) {\n              return _cheerio2.default.load(body);\n            }\n          };\n          findViewsText = _ramda2.default.find(_ramda2.default.pipe(_ramda2.default.match(/views/), _ramda2.default.complement(_ramda2.default.isEmpty)));\n          _context.next = 5;\n          return _regenerator2.default.awrap((0, _requestPromise2.default)(options));\n\n        case 5:\n          $ = _context.sent;\n          selText = $(selector).map(function (key, val) {\n            return $(val).text();\n          }).get();\n\n          if (!_ramda2.default.isEmpty(selText)) {\n            _context.next = 9;\n            break;\n          }\n\n          throw new Error('playlist is not suitable');\n\n        case 9:\n          return _context.abrupt('return', findViewsText(selText));\n\n        case 10:\n        case 'end':\n          return _context.stop();\n      }\n    }\n  }, null, this);\n}\n\nfunction viewsTextToNum(text) {\n  var numPart = _ramda2.default.pipe(_ramda2.default.trim, _ramda2.default.split(' '), _ramda2.default.head);\n  var ifEmptyToBeZero = _ramda2.default.when(_ramda2.default.equals('No'), _ramda2.default.always('0'));\n  var toNumber = _ramda2.default.pipe(_ramda2.default.replace(/,/g, ''), parseInt);\n\n  return _ramda2.default.pipe(numPart, ifEmptyToBeZero, toNumber)(text);\n}\n\nfunction views(pid) {\n  var viewsText;\n  return _regenerator2.default.async(function views$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          _context2.next = 2;\n          return _regenerator2.default.awrap(getViewsText(pid));\n\n        case 2:\n          viewsText = _context2.sent;\n          return _context2.abrupt('return', viewsTextToNum(viewsText));\n\n        case 4:\n        case 'end':\n          return _context2.stop();\n      }\n    }\n  }, null, this);\n}\n\nvar playlist = { views: views, getViewsText: getViewsText, viewsTextToNum: viewsTextToNum };\n\nexports.default = playlist;\nexports.views = views;\nexports.getViewsText = getViewsText;\nexports.viewsTextToNum = viewsTextToNum;"],"sourceRoot":"/source/"}